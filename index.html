<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AutoDiscovery â€” NLS-SES Exploration Results</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
  /* â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --accent: #2563EB;
    --accent-light: #DBEAFE;
    --green: #059669;
    --green-light: #D1FAE5;
    --gray-900: #111827;
    --gray-700: #374151;
    --gray-500: #6B7280;
    --gray-400: #9CA3AF;
    --gray-200: #E5E7EB;
    --gray-100: #F3F4F6;
    --gray-50: #F9FAFB;
    --red: #DC2626;
    --red-light: #FEE2E2;
    --serif: 'Georgia', 'Palatino Linotype', 'Times New Roman', serif;
    --sans: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
    --mono: 'SF Mono', 'Fira Code', 'Consolas', monospace;
  }

  html { font-size: 16px; -webkit-font-smoothing: antialiased; }
  body {
    font-family: var(--sans);
    color: var(--gray-700);
    background: #fff;
    line-height: 1.7;
  }

  /* â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .container {
    max-width: 960px;
    margin: 0 auto;
    padding: 0 2rem;
  }

  /* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  header {
    padding: 4rem 0 2.5rem;
    border-bottom: 1px solid var(--gray-200);
    margin-bottom: 3rem;
  }
  header h1 {
    font-family: var(--serif);
    font-size: 2.25rem;
    font-weight: 700;
    color: var(--gray-900);
    letter-spacing: -0.02em;
    line-height: 1.2;
    margin-bottom: 0.5rem;
  }
  header .subtitle {
    font-size: 1.05rem;
    color: var(--gray-500);
    margin-bottom: 1.5rem;
  }
  .params-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 0.75rem 1.5rem;
  }
  .param {
    display: flex;
    align-items: baseline;
    gap: 0.4rem;
  }
  .param-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--gray-400);
    white-space: nowrap;
  }
  .param-value {
    font-family: var(--mono);
    font-size: 0.85rem;
    color: var(--gray-900);
  }

  /* â”€â”€ Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  section {
    margin-bottom: 3.5rem;
  }
  section h2 {
    font-family: var(--serif);
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--gray-900);
    margin-bottom: 0.25rem;
  }
  section .section-desc {
    font-size: 0.9rem;
    color: var(--gray-500);
    margin-bottom: 1.5rem;
  }

  /* â”€â”€ Stats Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .stats-bar {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
  }
  .stat-card {
    background: var(--gray-50);
    border: 1px solid var(--gray-200);
    border-radius: 8px;
    padding: 1.25rem 1.5rem;
  }
  .stat-card .stat-number {
    font-family: var(--serif);
    font-size: 2rem;
    font-weight: 700;
    color: var(--gray-900);
    line-height: 1.1;
  }
  .stat-card .stat-label {
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--gray-500);
    margin-top: 0.25rem;
  }

  /* â”€â”€ Discovery Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .discovery-list {
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
  }
  .discovery-card {
    border: 1px solid var(--gray-200);
    border-radius: 8px;
    padding: 1.5rem 1.75rem;
    background: #fff;
    transition: box-shadow 0.15s ease;
  }
  .discovery-card:hover {
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
  }
  .card-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 1rem;
    margin-bottom: 0.75rem;
  }
  .card-rank {
    flex-shrink: 0;
    width: 2rem;
    height: 2rem;
    border-radius: 50%;
    background: var(--accent);
    color: #fff;
    font-family: var(--serif);
    font-size: 0.9rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .card-hypothesis {
    flex: 1;
    font-size: 0.95rem;
    line-height: 1.55;
    color: var(--gray-900);
  }
  .card-metrics {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem 1.25rem;
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--gray-100);
  }
  .metric {
    display: flex;
    align-items: baseline;
    gap: 0.35rem;
  }
  .metric-label {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.07em;
    color: var(--gray-400);
  }
  .metric-value {
    font-family: var(--mono);
    font-size: 0.82rem;
    color: var(--gray-700);
  }
  .badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.72rem;
    font-weight: 600;
    padding: 0.15rem 0.55rem;
    border-radius: 9999px;
    text-transform: uppercase;
    letter-spacing: 0.04em;
  }
  .badge-confirmed {
    background: var(--green-light);
    color: var(--green);
  }
  .badge-notsuprising {
    background: var(--gray-100);
    color: var(--gray-500);
  }
  .belief-arrow {
    font-family: var(--mono);
    font-size: 0.82rem;
    color: var(--gray-700);
  }
  .belief-arrow .arrow {
    color: var(--accent);
    margin: 0 0.15rem;
  }

  /* â”€â”€ Reward Bar (inline) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .reward-bar-container {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  .reward-bar-track {
    width: 80px;
    height: 6px;
    background: var(--gray-100);
    border-radius: 3px;
    overflow: hidden;
  }
  .reward-bar-fill {
    height: 100%;
    border-radius: 3px;
    background: var(--accent);
  }

  /* â”€â”€ Chart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .chart-container {
    max-width: 700px;
    margin: 0 auto;
    padding: 1rem 0;
  }
  .chart-container canvas {
    width: 100% !important;
  }

  /* â”€â”€ Methods â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .methods-box {
    background: var(--gray-50);
    border: 1px solid var(--gray-200);
    border-radius: 8px;
    padding: 1.75rem 2rem;
    font-size: 0.9rem;
    line-height: 1.75;
  }
  .methods-box p {
    margin-bottom: 0.75rem;
  }
  .methods-box p:last-child {
    margin-bottom: 0;
  }
  .methods-box strong {
    color: var(--gray-900);
  }

  /* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  footer {
    border-top: 1px solid var(--gray-200);
    padding: 2rem 0 3rem;
    margin-top: 1rem;
    text-align: center;
    font-size: 0.78rem;
    color: var(--gray-400);
  }

  /* â”€â”€ Upload Zone â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .upload-zone {
    border: 2px dashed var(--gray-400);
    border-radius: 8px;
    padding: 2.5rem 2rem;
    text-align: center;
    cursor: pointer;
    transition: border-color 0.2s ease, background 0.2s ease;
    background: var(--gray-50);
    margin-bottom: 1.5rem;
  }
  .upload-zone:hover,
  .upload-zone.drag-over {
    border-color: var(--accent);
    background: var(--accent-light);
  }
  .upload-zone .upload-icon {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    color: var(--gray-400);
    transition: color 0.2s ease;
  }
  .upload-zone:hover .upload-icon,
  .upload-zone.drag-over .upload-icon {
    color: var(--accent);
  }
  .upload-zone .upload-text {
    font-size: 0.95rem;
    color: var(--gray-500);
    line-height: 1.6;
  }
  .upload-zone .upload-text strong {
    color: var(--accent);
  }
  .upload-zone input[type="file"] {
    display: none;
  }

  /* â”€â”€ File Info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .file-info {
    display: none;
    margin-bottom: 1.5rem;
  }
  .file-info.visible { display: block; }
  .file-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem 1.5rem;
    margin-bottom: 1rem;
    padding: 0.75rem 1rem;
    background: var(--green-light);
    border-radius: 6px;
    font-size: 0.85rem;
    color: var(--green);
    align-items: center;
  }
  .file-meta .file-name {
    font-weight: 600;
    color: var(--gray-900);
  }

  /* â”€â”€ Preview Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .preview-table-wrap {
    overflow-x: auto;
    margin-bottom: 1.5rem;
    border: 1px solid var(--gray-200);
    border-radius: 6px;
  }
  .preview-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.82rem;
    font-family: var(--mono);
  }
  .preview-table caption {
    text-align: left;
    padding: 0.6rem 0.75rem;
    font-family: var(--sans);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--gray-400);
    background: var(--gray-50);
    border-bottom: 1px solid var(--gray-200);
  }
  .preview-table th {
    text-align: left;
    padding: 0.5rem 0.75rem;
    font-weight: 600;
    color: var(--gray-900);
    background: var(--gray-50);
    border-bottom: 2px solid var(--gray-200);
    white-space: nowrap;
    font-family: var(--sans);
    font-size: 0.78rem;
    text-transform: uppercase;
    letter-spacing: 0.04em;
  }
  .preview-table td {
    text-align: left;
    padding: 0.4rem 0.75rem;
    border-bottom: 1px solid var(--gray-100);
    color: var(--gray-700);
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .preview-table tbody tr:last-child td {
    border-bottom: none;
  }
  .preview-table tbody tr:hover {
    background: var(--gray-50);
  }

  /* â”€â”€ Column Schema â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .column-schema {
    margin-bottom: 1.5rem;
  }
  .column-schema-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.5rem;
  }
  .col-row {
    display: grid;
    grid-template-columns: 140px 90px 1fr;
    gap: 0.75rem;
    align-items: center;
    padding: 0.4rem 0;
    border-bottom: 1px solid var(--gray-100);
  }
  .col-row:last-child { border-bottom: none; }
  .col-name {
    font-family: var(--mono);
    font-size: 0.82rem;
    font-weight: 600;
    color: var(--gray-900);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .col-type {
    font-size: 0.72rem;
    font-weight: 600;
    padding: 0.1rem 0.5rem;
    border-radius: 9999px;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    text-align: center;
    white-space: nowrap;
  }
  .col-type-numeric { background: #DBEAFE; color: #1D4ED8; }
  .col-type-categorical { background: #FEF3C7; color: #92400E; }
  .col-type-text { background: #E0E7FF; color: #4338CA; }
  .col-type-date { background: #D1FAE5; color: #065F46; }
  .col-type-boolean { background: #FCE7F3; color: #9D174D; }
  .col-desc-input {
    font-family: var(--sans);
    font-size: 0.82rem;
    padding: 0.35rem 0.6rem;
    border: 1px solid var(--gray-200);
    border-radius: 4px;
    color: var(--gray-700);
    background: #fff;
    transition: border-color 0.15s ease;
    width: 100%;
  }
  .col-desc-input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
  }
  .col-desc-input::placeholder {
    color: var(--gray-400);
    font-style: italic;
  }

  /* â”€â”€ CTA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .cta-area {
    display: none;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
    margin-bottom: 1rem;
  }
  .cta-area.visible { display: flex; }
  .cta-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.7rem 1.5rem;
    background: var(--accent);
    color: #fff;
    font-family: var(--sans);
    font-size: 0.9rem;
    font-weight: 600;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    text-decoration: none;
    transition: background 0.15s ease, box-shadow 0.15s ease;
    letter-spacing: 0.01em;
  }
  .cta-btn:hover {
    background: #1D4ED8;
    box-shadow: 0 2px 8px rgba(37, 99, 235, 0.25);
  }
  .cta-hint {
    font-size: 0.78rem;
    color: var(--gray-500);
    line-height: 1.5;
    max-width: 380px;
  }

  /* â”€â”€ Demo Divider â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .demo-divider {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin: 3rem 0 2.5rem;
  }
  .demo-divider::before,
  .demo-divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--gray-200);
  }
  .demo-divider span {
    font-family: var(--serif);
    font-size: 0.85rem;
    color: var(--gray-400);
    white-space: nowrap;
    letter-spacing: 0.02em;
  }

  /* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  @media (max-width: 640px) {
    .container { padding: 0 1rem; }
    header h1 { font-size: 1.6rem; }
    section h2 { font-size: 1.25rem; }
    .card-header { flex-direction: column; }
    .card-metrics { gap: 0.4rem 0.75rem; }
    .params-grid { grid-template-columns: 1fr 1fr; }
    .stats-bar { grid-template-columns: 1fr 1fr; }
    .col-row { grid-template-columns: 1fr; gap: 0.25rem; }
    .upload-zone { padding: 1.5rem 1rem; }
    .cta-area { flex-direction: column; align-items: flex-start; }
  }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="container">
<header>
  <h1>AutoDiscovery</h1>
  <p class="subtitle">Automated Scientific Discovery via Bayesian Surprise &amp; Monte Carlo Tree Search â€” NLS Socioeconomic Status Dataset</p>
  <div class="params-grid">
    <div class="param">
      <span class="param-label">Model</span>
      <span class="param-value">gpt-4o</span>
    </div>
    <div class="param">
      <span class="param-label">Experiments</span>
      <span class="param-value">4 rounds Ã— 8 candidates</span>
    </div>
    <div class="param">
      <span class="param-label">Dataset</span>
      <span class="param-value">nls_ses (DiscoveryBench)</span>
    </div>
    <div class="param">
      <span class="param-label">Belief Mode</span>
      <span class="param-value">boolean_cat</span>
    </div>
    <div class="param">
      <span class="param-label">Reward</span>
      <span class="param-value">KL Divergence</span>
    </div>
    <div class="param">
      <span class="param-label">MCTS Selection</span>
      <span class="param-value">UCB1 (recursive)</span>
    </div>
    <div class="param">
      <span class="param-label">Belief Samples</span>
      <span class="param-value">30</span>
    </div>
    <div class="param">
      <span class="param-label">Run Time</span>
      <span class="param-value">2026-02-21 12:20</span>
    </div>
  </div>
</header>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GUIDED INTERACTION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="try-section">
  <h2>Try Your Own Dataset</h2>
  <p class="section-desc">Upload a CSV file to preview its structure, then run AutoDiscovery on it for free.</p>

  <!-- Upload Zone -->
  <div class="upload-zone" id="uploadZone">
    <div class="upload-icon">â¬†</div>
    <div class="upload-text">
      <strong>Drag &amp; drop a CSV file</strong> here, or click to browse<br>
      <span style="font-size:0.8rem; color:var(--gray-400)">Plain CSV only Â· Parsed locally in your browser Â· Nothing uploaded</span>
    </div>
    <input type="file" id="csvInput" accept=".csv,text/csv">
  </div>

  <!-- File Info (hidden until upload) -->
  <div class="file-info" id="fileInfo">
    <div class="file-meta" id="fileMeta"></div>

    <!-- Data Preview Table -->
    <div class="preview-table-wrap">
      <table class="preview-table" id="previewTable">
        <caption>Data Preview â€” First 5 Rows</caption>
        <thead id="previewHead"></thead>
        <tbody id="previewBody"></tbody>
      </table>
    </div>

    <!-- Column Schema -->
    <div class="column-schema">
      <h3 style="font-family:var(--serif); font-size:1.1rem; font-weight:700; color:var(--gray-900); margin-bottom:0.75rem;">Column Descriptions <span style="font-weight:400; font-size:0.82rem; color:var(--gray-400)">(optional)</span></h3>
      <p style="font-size:0.82rem; color:var(--gray-500); margin-bottom:0.75rem;">Briefly describe what each column represents. This helps the AI generate better hypotheses.</p>
      <div class="column-schema-grid" id="columnSchema"></div>
    </div>

    <!-- CTA -->
    <div class="cta-area visible" id="ctaArea">
      <a href="https://autodiscovery.allen.ai/runs" target="_blank" rel="noopener" class="cta-btn">
        â–¶ Run on AstaLabs (Free)
      </a>
      <span class="cta-hint">Upload your dataset there to run AutoDiscovery.<br>Free credits available until Feb 28, 2026.</span>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DEMO DIVIDER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="demo-divider">
  <span>â¬‡&ensp;Demo Results (NLS SES Dataset)&ensp;â¬‡</span>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXPLORATION STATS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section>
  <h2>Exploration Summary</h2>
  <p class="section-desc">Aggregate statistics from the MCTS exploration run.</p>
  <div class="stats-bar">
    <div class="stat-card">
      <div class="stat-number">4</div>
      <div class="stat-label">Hypotheses Tested</div>
    </div>
    <div class="stat-card">
      <div class="stat-number">0</div>
      <div class="stat-label">Surprising Discoveries</div>
    </div>
    <div class="stat-card">
      <div class="stat-number">2.20</div>
      <div class="stat-label">Mean KL Divergence</div>
    </div>
    <div class="stat-card">
      <div class="stat-number">0.440</div>
      <div class="stat-label">Mean Reward</div>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DISCOVERY FEED â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section>
  <h2>Discovery Feed</h2>
  <p class="section-desc">Hypotheses ranked by self-reward score. Each card shows the experimental finding, belief update, and information-theoretic metrics.</p>

  <div class="discovery-list">

    <!-- â”€â”€ Card 1 â”€â”€ -->
    <div class="discovery-card">
      <div class="card-header">
        <div class="card-rank">1</div>
        <div class="card-hypothesis">
          Socioeconomic status (SES) is a significant predictor of the composite ASVAB score ability among respondents of the NLS dataset.
        </div>
      </div>
      <div class="card-metrics">
        <div class="metric">
          <span class="metric-label">Surprise</span>
          <span class="badge badge-notsuprising">âœ— Expected</span>
        </div>
        <div class="metric">
          <span class="metric-label">Belief</span>
          <span class="belief-arrow">0.742 <span class="arrow">â†’</span> 0.907</span>
        </div>
        <div class="metric">
          <span class="metric-label">Î” Belief</span>
          <span class="metric-value">+0.165</span>
        </div>
        <div class="metric">
          <span class="metric-label">KL Divergence</span>
          <span class="metric-value">3.591</span>
        </div>
        <div class="metric">
          <span class="metric-label">Reward</span>
          <div class="reward-bar-container">
            <span class="metric-value">0.718</span>
            <div class="reward-bar-track"><div class="reward-bar-fill" style="width:71.8%"></div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ Card 2 â”€â”€ -->
    <div class="discovery-card">
      <div class="card-header">
        <div class="card-rank">2</div>
        <div class="card-hypothesis">
          Black respondents have significantly different class percentiles compared to their White and Hispanic counterparts.
        </div>
      </div>
      <div class="card-metrics">
        <div class="metric">
          <span class="metric-label">Surprise</span>
          <span class="badge badge-notsuprising">âœ— Expected</span>
        </div>
        <div class="metric">
          <span class="metric-label">Belief</span>
          <span class="belief-arrow">0.726 <span class="arrow">â†’</span> 0.890</span>
        </div>
        <div class="metric">
          <span class="metric-label">Î” Belief</span>
          <span class="metric-value">+0.164</span>
        </div>
        <div class="metric">
          <span class="metric-label">KL Divergence</span>
          <span class="metric-value">3.258</span>
        </div>
        <div class="metric">
          <span class="metric-label">Reward</span>
          <div class="reward-bar-container">
            <span class="metric-value">0.652</span>
            <div class="reward-bar-track"><div class="reward-bar-fill" style="width:65.2%"></div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ Card 3 â”€â”€ -->
    <div class="discovery-card">
      <div class="card-header">
        <div class="card-rank">3</div>
        <div class="card-hypothesis">
          The effect of race on ASVAB-derived abilities is mediated through socioeconomic status, indicating an indirect effect of race on ability through SES.
        </div>
      </div>
      <div class="card-metrics">
        <div class="metric">
          <span class="metric-label">Surprise</span>
          <span class="badge badge-notsuprising">âœ— Expected</span>
        </div>
        <div class="metric">
          <span class="metric-label">Belief</span>
          <span class="belief-arrow">0.734 <span class="arrow">â†’</span> 0.838</span>
        </div>
        <div class="metric">
          <span class="metric-label">Î” Belief</span>
          <span class="metric-value">+0.104</span>
        </div>
        <div class="metric">
          <span class="metric-label">KL Divergence</span>
          <span class="metric-value">1.192</span>
        </div>
        <div class="metric">
          <span class="metric-label">Reward</span>
          <div class="reward-bar-container">
            <span class="metric-value">0.238</span>
            <div class="reward-bar-track"><div class="reward-bar-fill" style="width:23.8%"></div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ Card 4 â”€â”€ -->
    <div class="discovery-card">
      <div class="card-header">
        <div class="card-rank">4</div>
        <div class="card-hypothesis">
          There is a significant difference in ability scores between males and females within each racial group.
        </div>
      </div>
      <div class="card-metrics">
        <div class="metric">
          <span class="metric-label">Surprise</span>
          <span class="badge badge-notsuprising">âœ— Expected</span>
        </div>
        <div class="metric">
          <span class="metric-label">Belief</span>
          <span class="belief-arrow">0.629 <span class="arrow">â†’</span> 0.538</span>
        </div>
        <div class="metric">
          <span class="metric-label">Î” Belief</span>
          <span class="metric-value">âˆ’0.091</span>
        </div>
        <div class="metric">
          <span class="metric-label">KL Divergence</span>
          <span class="metric-value">0.759</span>
        </div>
        <div class="metric">
          <span class="metric-label">Reward</span>
          <div class="reward-bar-container">
            <span class="metric-value">0.152</span>
            <div class="reward-bar-track"><div class="reward-bar-fill" style="width:15.2%"></div></div>
          </div>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BELIEF DISTRIBUTION CHART â•â•â•â•â•â•â•â•â•â•â•â• -->
<section>
  <h2>Belief Distribution</h2>
  <p class="section-desc">Prior vs. posterior mean belief (P(H|data)) for each tested hypothesis, illustrating how evidence shifted confidence.</p>
  <div class="chart-container">
    <canvas id="beliefChart" height="280"></canvas>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• KL DIVERGENCE CHART â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section>
  <h2>Information Gain</h2>
  <p class="section-desc">KL Divergence â€” bits of information gained from each experiment, measuring how much the posterior diverged from the prior.</p>
  <div class="chart-container">
    <canvas id="klChart" height="220"></canvas>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BELIEF CATEGORIES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section>
  <h2>Belief Category Breakdown</h2>
  <p class="section-desc">Detailed prior and posterior belief sample distributions across the five confidence categories.</p>
  <div class="chart-container">
    <canvas id="beliefCatChart" height="300"></canvas>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• METHODS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section>
  <h2>Methodology</h2>
  <div class="methods-box">
    <p>
      <strong>AutoDiscovery</strong> is an AI-driven scientific discovery framework developed by the Allen Institute for AI (AI2).
      It uses a <strong>Monte Carlo Tree Search (MCTS)</strong> strategy to explore a combinatorial space of hypotheses and experiments,
      selecting the most informative path at each step via the <strong>UCB1</strong> bandit algorithm.
    </p>
    <p>
      At each node, a large language model proposes a hypothesis and designs an experiment (including executable code).
      After execution, a separate <strong>Bayesian Belief Update</strong> module evaluates the result:
      an LLM jury samples categorical beliefs ("definitely true" â†’ "definitely false") both <em>before</em> (prior) and <em>after</em> (posterior)
      seeing the experimental evidence, using <em>n</em> = 30 independent samples per distribution.
    </p>
    <p>
      The <strong>reward signal</strong> is derived from the <strong>KL Divergence</strong> between the prior and posterior belief distributions,
      scaled by a configurable factor (here Îº = 5). Larger divergence means the experiment was more <em>informative</em> â€” it changed the model's beliefs substantially.
      A "surprise" flag (not triggered in this run) would indicate findings that contradicted the prior expectation.
    </p>
    <p>
      The tree is grown iteratively: each round selects a parent node, generates candidate experiments, runs the most promising one,
      updates beliefs, and back-propagates the reward. This demo ran <strong>4 MCTS iterations</strong> with 8 candidate experiments per round,
      using <strong>GPT-4o</strong> as both the hypothesis-generating and belief-evaluating model.
    </p>
  </div>
</section>

<footer>
  AutoDiscovery Dashboard &middot; Generated 2026-02-21 &middot; Data: NLS Socioeconomic Status (DiscoveryBench)
</footer>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCRIPTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// â”€â”€ Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const hypotheses = [
  'H1: SES â†’ ASVAB Score',
  'H2: Race â†’ Class Percentile',
  'H3: Race â†’ ASVAB (SES mediator)',
  'H4: Gender â†’ Ability (by race)'
];

const priors     = [0.742, 0.726, 0.734, 0.629];
const posteriors = [0.907, 0.890, 0.838, 0.538];
const klValues   = [3.591, 3.258, 1.192, 0.759];

// â”€â”€ Belief Chart (grouped bar) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ctxBelief = document.getElementById('beliefChart').getContext('2d');
new Chart(ctxBelief, {
  type: 'bar',
  data: {
    labels: hypotheses,
    datasets: [
      {
        label: 'Prior P(H)',
        data: priors,
        backgroundColor: '#DBEAFE',
        borderColor: '#93C5FD',
        borderWidth: 1,
        borderRadius: 3,
        barPercentage: 0.7,
        categoryPercentage: 0.65
      },
      {
        label: 'Posterior P(H|E)',
        data: posteriors,
        backgroundColor: '#2563EB',
        borderColor: '#1D4ED8',
        borderWidth: 1,
        borderRadius: 3,
        barPercentage: 0.7,
        categoryPercentage: 0.65
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      legend: {
        position: 'top',
        labels: { font: { family: "'Inter', system-ui, sans-serif", size: 12 }, padding: 16 }
      },
      tooltip: {
        callbacks: {
          label: ctx => `${ctx.dataset.label}: ${ctx.parsed.y.toFixed(3)}`
        }
      }
    },
    scales: {
      y: {
        beginAtZero: true,
        max: 1,
        ticks: {
          font: { family: "'Inter', system-ui, sans-serif", size: 11 },
          callback: v => v.toFixed(1)
        },
        grid: { color: '#F3F4F6' }
      },
      x: {
        ticks: { font: { family: "'Inter', system-ui, sans-serif", size: 11 } },
        grid: { display: false }
      }
    }
  }
});

// â”€â”€ KL Divergence Chart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ctxKL = document.getElementById('klChart').getContext('2d');
new Chart(ctxKL, {
  type: 'bar',
  data: {
    labels: hypotheses,
    datasets: [{
      label: 'KL Divergence (bits)',
      data: klValues,
      backgroundColor: klValues.map(v => v > 2 ? '#059669' : v > 1 ? '#10B981' : '#D1FAE5'),
      borderColor: klValues.map(v => v > 2 ? '#047857' : v > 1 ? '#059669' : '#6EE7B7'),
      borderWidth: 1,
      borderRadius: 3,
      barPercentage: 0.55
    }]
  },
  options: {
    responsive: true,
    indexAxis: 'y',
    plugins: {
      legend: { display: false },
      tooltip: {
        callbacks: {
          label: ctx => `KL Divergence: ${ctx.parsed.x.toFixed(3)}`
        }
      }
    },
    scales: {
      x: {
        beginAtZero: true,
        ticks: {
          font: { family: "'Inter', system-ui, sans-serif", size: 11 },
          callback: v => v.toFixed(1)
        },
        grid: { color: '#F3F4F6' }
      },
      y: {
        ticks: { font: { family: "'Inter', system-ui, sans-serif", size: 11 } },
        grid: { display: false }
      }
    }
  }
});

// â”€â”€ Belief Category Breakdown (stacked bar) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const categories = ['Definitely True', 'Maybe True', 'Uncertain', 'Maybe False', 'Definitely False'];
const catColors = ['#1D4ED8', '#60A5FA', '#D1D5DB', '#F59E0B', '#DC2626'];
const catColorsBorder = ['#1E40AF', '#3B82F6', '#9CA3AF', '#D97706', '#B91C1C'];

// Prior data (from n=30 samples)
const priorData = {
  'H1 Prior':     [0,  30, 0,  0,  0],
  'H1 Post':      [58,  2, 0,  0,  0],
  'H2 Prior':     [0,  28, 2,  0,  0],
  'H2 Post':      [54,  6, 0,  0,  0],
  'H3 Prior':     [0,  29, 1,  0,  0],
  'H3 Post':      [34, 26, 0,  0,  0],
  'H4 Prior':     [0,  16, 14, 0,  0],
  'H4 Post':      [0,  26, 6,  28, 0],
};

const catLabels = Object.keys(priorData);
const catDatasets = categories.map((cat, i) => ({
  label: cat,
  data: catLabels.map(k => priorData[k][i]),
  backgroundColor: catColors[i],
  borderColor: catColorsBorder[i],
  borderWidth: 1,
  borderRadius: 2,
  barPercentage: 0.75,
  categoryPercentage: 0.8
}));

const ctxCat = document.getElementById('beliefCatChart').getContext('2d');
new Chart(ctxCat, {
  type: 'bar',
  data: {
    labels: catLabels,
    datasets: catDatasets
  },
  options: {
    responsive: true,
    plugins: {
      legend: {
        position: 'top',
        labels: { font: { family: "'Inter', system-ui, sans-serif", size: 11 }, padding: 12, boxWidth: 12 }
      },
      tooltip: {
        callbacks: {
          label: ctx => `${ctx.dataset.label}: ${ctx.parsed.y} samples`
        }
      }
    },
    scales: {
      x: {
        stacked: true,
        ticks: { font: { family: "'Inter', system-ui, sans-serif", size: 10 }, maxRotation: 45 },
        grid: { display: false }
      },
      y: {
        stacked: true,
        beginAtZero: true,
        max: 65,
        ticks: { font: { family: "'Inter', system-ui, sans-serif", size: 11 } },
        grid: { color: '#F3F4F6' },
        title: {
          display: true,
          text: 'Belief Samples (n)',
          font: { family: "'Inter', system-ui, sans-serif", size: 12 }
        }
      }
    }
  }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â”€â”€ CSV Upload & Preview â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function() {
  const zone   = document.getElementById('uploadZone');
  const input  = document.getElementById('csvInput');
  const info   = document.getElementById('fileInfo');
  const meta   = document.getElementById('fileMeta');
  const thead  = document.getElementById('previewHead');
  const tbody  = document.getElementById('previewBody');
  const schema = document.getElementById('columnSchema');

  // Click to open file picker
  zone.addEventListener('click', () => input.click());

  // Drag & drop events
  ['dragenter','dragover'].forEach(e => {
    zone.addEventListener(e, ev => { ev.preventDefault(); zone.classList.add('drag-over'); });
  });
  ['dragleave','drop'].forEach(e => {
    zone.addEventListener(e, ev => { ev.preventDefault(); zone.classList.remove('drag-over'); });
  });
  zone.addEventListener('drop', ev => {
    const file = ev.dataTransfer.files[0];
    if (file) handleFile(file);
  });
  input.addEventListener('change', () => {
    if (input.files[0]) handleFile(input.files[0]);
  });

  function handleFile(file) {
    const reader = new FileReader();
    reader.onload = e => {
      const text = e.target.result;
      const parsed = parseCSV(text);
      if (!parsed || parsed.rows.length === 0) {
        alert('Could not parse CSV. Please check the file format.');
        return;
      }
      renderPreview(file.name, parsed);
    };
    reader.readAsText(file);
  }

  // Minimal robust CSV parser (handles quoted fields)
  function parseCSV(text) {
    const lines = [];
    let current = [];
    let field = '';
    let inQuote = false;
    for (let i = 0; i < text.length; i++) {
      const c = text[i];
      if (inQuote) {
        if (c === '"') {
          if (text[i+1] === '"') { field += '"'; i++; }
          else inQuote = false;
        } else { field += c; }
      } else {
        if (c === '"') { inQuote = true; }
        else if (c === ',') { current.push(field.trim()); field = ''; }
        else if (c === '\n' || c === '\r') {
          if (c === '\r' && text[i+1] === '\n') i++;
          current.push(field.trim()); field = '';
          if (current.some(f => f !== '')) lines.push(current);
          current = [];
        } else { field += c; }
      }
    }
    current.push(field.trim());
    if (current.some(f => f !== '')) lines.push(current);
    if (lines.length < 2) return null;
    return { headers: lines[0], rows: lines.slice(1) };
  }

  // Infer column type from sample values
  function inferType(values) {
    const sample = values.filter(v => v !== '' && v !== 'NA' && v !== 'N/A' && v !== 'null').slice(0, 50);
    if (sample.length === 0) return 'text';
    // Boolean?
    const boolSet = new Set(sample.map(v => v.toLowerCase()));
    if (boolSet.size <= 2 && [...boolSet].every(v => ['true','false','0','1','yes','no'].includes(v))) return 'boolean';
    // Date?
    const datePattern = /^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/;
    if (sample.every(v => datePattern.test(v))) return 'date';
    // Numeric?
    if (sample.every(v => !isNaN(Number(v)))) return 'numeric';
    // Categorical (low cardinality)?
    const unique = new Set(sample);
    if (unique.size <= Math.max(10, sample.length * 0.3)) return 'categorical';
    return 'text';
  }

  function renderPreview(fileName, data) {
    const { headers, rows } = data;
    const nRows = rows.length;
    const nCols = headers.length;

    // Show info area
    info.classList.add('visible');

    // Meta bar
    meta.innerHTML = `
      <span class="file-name">ðŸ“„ ${esc(fileName)}</span>
      <span>${nRows.toLocaleString()} rows</span>
      <span>${nCols} columns</span>
    `;

    // Preview table header
    thead.innerHTML = '<tr>' + headers.map(h => `<th>${esc(h)}</th>`).join('') + '</tr>';

    // Preview table body (first 5 rows)
    const preview = rows.slice(0, 5);
    tbody.innerHTML = preview.map(row =>
      '<tr>' + headers.map((_, i) => `<td>${esc(row[i] || '')}</td>`).join('') + '</tr>'
    ).join('');

    // Column schema with type inference + description inputs
    const colValues = headers.map((_, ci) => rows.map(r => r[ci] || ''));
    schema.innerHTML = headers.map((h, i) => {
      const type = inferType(colValues[i]);
      const typeClass = 'col-type-' + type;
      const placeholders = {
        numeric: 'e.g. "Annual income in USD"',
        categorical: 'e.g. "Ethnic group (Black, White, Hispanic)"',
        text: 'e.g. "Open-ended response text"',
        date: 'e.g. "Date of survey interview"',
        boolean: 'e.g. "Whether respondent completed college"'
      };
      return `
        <div class="col-row">
          <span class="col-name" title="${esc(h)}">${esc(h)}</span>
          <span class="col-type ${typeClass}">${type}</span>
          <input type="text" class="col-desc-input" placeholder='${placeholders[type] || "Describe this columnâ€¦"}'>
        </div>`;
    }).join('');

    // Scroll into view
    info.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  function esc(s) {
    const d = document.createElement('div');
    d.textContent = s;
    return d.innerHTML;
  }
})();
</script>
</body>
</html>
